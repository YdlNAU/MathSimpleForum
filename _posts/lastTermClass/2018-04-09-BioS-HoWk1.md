---
layout: post
title:  第一次生物统计课作业
date:   2018-03-13 15:31:01 +0800
categories: Biostatistics
tags: Notes
author: Yu Dalang
---

* content
{:toc}

---

> 吾尝终日而思矣,不如须臾之所学也．
>            ——荀子《劝学》

#第一次作业：

## 第一题

*请简述生物统计学的概念和意义，调查你课题组需要用到的统计学知识以及实现的软件。*

陈洛南老师说："生物统计就是统计，应用在生物问题上而已。"
如果说是否有一门课任何专业的学生都需要上，那么这门课毫无疑问是《英语》。如果说是否有一门课任何自然科学专业的学生都需要上，那么我想这门课是《统计》

**概念：** "Statistics is the science whereby inferences are made about specific random phenomena on the basis relatively limited sample material !"^[《FUNDAMENTALS OF BIOSTATISTICS》, Bernard Rosner]

**意义：**生物学是一门实验科学，也是一门技术主导的科学。不管你从事的是生物学的哪一个分支（哪怕是计算生物学与非应用生物信息学），都不可能完全脱离实验，而实验所得到的的结果几乎无一例外地都带有或多或少的不确定性，即实验误差。在这种情况下，不用统计学而想要得到正确的结论是不同可能的。

我们课题组主要做的是：开发更好地估计正选择、重组率和群体历史的方法，也做数据分析，此外还开发软件。我们需要统计学中的参数估计的基本知识，如构造无偏估计统计量；利用最基本的卡方检验与判断基因频率和基因型频率是否满足哈迪为伯格定理等等。

## 第二题

*生物统计学能分析的数据类型有哪些?调查你课题组有哪些数据类型需要用生物统计学分析？*

统计学中能分析的数据应该是结构性数据，先说下统计学中数据的分类：

- 定类数据（Nominal）：最低级数据，表示个体的分类或属性，没有大小次序关系，例如对性别、民族等进行编号。
- 定序数据（Ordinal）：中间级数据，表示个体在某个有序排列中所处的状态，例如按受试者入组时的TNM肿瘤分期（I到IV）分为四个组，编码1至4。
- 定距数据（Internal）：数据具有间距特征，有单位，但没有绝对零点，如体温。
- 定比数据（Ratio）：最高级数据，有单位，也有绝对零点，比如身高。

我们具体能分析的数据包括综合上述数据的生物实验数据，医学数据，疾病统计学数据等。

我们课题组有基因组变异数据需要分析(VCF文件)。

## 第三题

*假如你要研究某地区的糖尿病与肥胖的关系，请就此例说明群体和样本的概念，以及如何选取样本以完成该研究。*

总体为某地区所有人的糖尿病患病情况和肥胖情况；样本为实际进行研究人群的糖尿病患病情况和肥胖情况。

选取样本时要 1）随机选择。2）样本最好大一些。应注意除该两个因素外其它因素没有偏向性（如年龄、性别、生活习惯等）。


## 第四题

*从一个有限总体中，采用放回式抽样和非放回式抽样，所得到的样本有什么不同？*

题目说的有些笼统，假设和上课一样的情景，即在一个结果非此即彼的总体中抽样，比如从装有一定数量的红球和白球的总体中抽样。定义样本为抽到红球的个数：

那么对于放回抽样，特定红球个数的概率满足二项分布；对于不放回抽样满足负二项分布。

## 第五题

在某次射击比赛中，运动员A射击10次，命中环数如下：
     6, 8, 7, 8, 6, 10, 5, 8, 7, 6；
 求：
（1）依据数据，求运动员A命中环数的算术平均数和中位数；

（2）依据数据，求运动员A命中环数的样本方差和标准差；

（3）依据数据，求运动员A命中环数的变异系数；


```r
x <- c( 6, 8, 7, 8, 6, 10, 5, 8, 7, 6)
cat("算数平均数为：" , mean(x),"\n")
## 算数平均数为： 7.1
cat("中位数为：" , median(x))
## 中位数为： 7
cat("样本方差为：" , sd(x))
## 样本方差为： 1.449138
cat("标准差为：" , sd(x)^2)
## 标准差为： 2.1
cat("变异系数为：" , sd(x) / mean(x) * 100 ,"%")
## 变异系数为： 20.41039 %
```
根据《R语言实战》通过pastecs包中的stat.desc()函数计算描述性统计量


```r
library(pastecs)
stat.desc(x)
```

```
##      nbr.val     nbr.null       nbr.na          min          max 
##   10.0000000    0.0000000    0.0000000    5.0000000   10.0000000 
##        range          sum       median         mean      SE.mean 
##    5.0000000   71.0000000    7.0000000    7.1000000    0.4582576 
## CI.mean.0.95          var      std.dev     coef.var 
##    1.0366506    2.1000000    1.4491377    0.2041039
```


## 第六题

设A，B，C是样本空间Ω中的事件，
    Ω={1,2,3,4,5,6,7,8} , P(i)=1/8, i=1,…,8.
    A={1,3,5,7}, B={1,2,3,4,5}, C={4,5,6,7,8}
    
分别求出表示出下列事件的概率：
(1) A(BC);
(2)$\bar{A \cup B}$ ; 
(3) $A +\bar{A}$ ;
(4) $A \cup B \cup C$ ; 
(5)$\bar{C}\bar{B}$ ;
(6) $\bar{\Omega}$;

解一：人工计算

$$P(ABC)=P(\{5\})=\frac{1}{8}$$

$P( \bar{A \cup B} ) =  1 - P(A \cup B) = 1 - (P(A)+P(B)-P(AB))=$ 0.25 


$P(A +\bar{A})=P(\Omega)=1$

$P(A \cup B \cup C)=P(\Omega)=1$ 

$P( \bar{C}\bar{B} ) = P( \bar{ C \cup B } ) =1 - ( P(C) + P(B) -P(BC) ) =1 - ( 5/8 +5/8 -2/8 )= 0$

$P( \bar{\Omega} ) = P( \phi) = 0$


解二：编程实现


```r
Omega <- 1:8
A <- c(1,3,5,7)
B <- 1:5
C <- 4:8
# question1:
intersect(B,C) %>% intersect(. , A) %>% length() / length(Omega)
```

```
## [1] 0.125
```

```r
# question2:
union(A,B) %>% setdiff(Omega,.) %>% length() / length(Omega)
```

```
## [1] 0.25
```

```r
# question3:
length(A) / length(Omega) + setdiff(Omega,A) %>% length() / length(Omega)
```

```
## [1] 1
```

```r
# question4:
union(A,B) %>% union(. ,C) %>% length() / length(Omega)
```

```
## [1] 1
```

```r
# question5:
intersect( setdiff(Omega,C) ,setdiff(Omega,B)) %>% length() / length(Omega) 
```

```
## [1] 0
```

```r
# question6:
# of course0
```



## 第七题

解一：人工分析加编程实现

(1). $\frac{ C_{6}^{2} \cdot C_{5}^{1} }{ C_{11}^{3} }$


```r
choose(6,2)*choose(5,1)/choose(11,3)
```

```
## [1] 0.4545455
```

(2). $C_{3}^{2} \cdot (\frac{6}{11})^2 \cdot (\frac{5}{11})$


```r
choose(3,2)*(6/11)^2*5/11
```

```
## [1] 0.40571
```


(3). $\frac{6}{11} \cdot \frac{5}{10} \cdot \frac{5}{9}$


```r
6/11*5/10*5/9
```

```
## [1] 0.1515152
```


(4). $\frac{6}{11} \cdot \frac{5}{11} \cdot \frac{6}{11}$


```r
6/11*5/11*6/11
```

```
## [1] 0.1352367
```


解二：程序模拟抽样

R中要避免显式for循环，可以用apply系列函数！[R语言中apply函数簇](http://blog.fens.me/r-apply/)


```r
# 设白球为0,黑球为1
# 设置了随机数种子,使模拟可重复
set.seed(1234)
## question1
x <- c(rep(0,5),rep(1,6))
simulation1 <- function(times) {
  numOfHit <- sapply(1:times,function(i) sum(sample(x = x,size = 3,replace = F))==2 ) %>% sum()
  numOfHit / times
}

# 我们重复抽样分别模拟100，10000,1000000次
c(simulation1(100),simulation1(10000),simulation1(1000000))
```

```
## [1] 0.430000 0.454600 0.454955
```

```r
## question2
simulation2 <- function(times) {
  numOfHit <- sapply(1:times,function(i) sum(sample(x = x,size = 3,replace = T))==2 ) %>% sum()
  numOfHit / times
}
# 我们重复抽样分别模拟100，10000,1000000次
c(simulation2(100),simulation2(10000),simulation2(1000000))
```

```
## [1] 0.340000 0.405300 0.405851
```

```r
## question3

simulation3 <- function(times) {
  numOfHit <- sapply(1:times,function(i) sum(sample(x = x,size = 3,replace = F)==c(1,0,1))==3 ) %>% sum()
  numOfHit / times
}
# 我们重复抽样分别模拟100，10000,1000000次
c(simulation3(100),simulation3(10000),simulation3(1000000))
```

```
## [1] 0.130000 0.157900 0.151621
```

```r
## question4

simulation4 <- function(times) {
  numOfHit <- sapply(1:times,function(i) sum(sample(x = x,size = 3,replace = T)==c(1,0,1))==3 ) %>% sum()
  numOfHit / times
}
# 我们重复抽样分别模拟100，10000,1000000次
c(simulation4(100),simulation4(10000),simulation4(1000000))
```

```
## [1] 0.160000 0.133200 0.135217
```

## 第八题

证明：

(1). 如果A,B独立，则$\bar{A},\bar{B}$独立。

$$P(\bar{A} \bar{B})=P(\bar{A \cup B})=1-P(A \cup B)=1-(P(A)+P(B)-P(AB))$$

$$\because P(AB)=P(A)P(B)$$

$$=(1-P(A))(1-P(B))=P(\bar{A})P(\bar{B})$$

(2). 如果$P(A|B)=P(A|\bar{B})$则A,B独立

$$\frac{P(AB)}{P{B}} = \frac{P(A\bar{B})}{P(\bar{B})}$$

$$P(B)P(A\bar{B})=P(AB) \cdot (1 -P(B))$$

$$\because P(A\bar{B})=P(A)-P(AB)$$

$$\therefore P(B)(P(A) -P(AB))=P(AB)- P(AB) \cdot P(B)$$

展开得：$$P(AB)=P(A)P(B)$$


## 第九题

$$P(AB)= P(A \cup B) - P(A) - P(B) = r - p - q$$

$P(A\bar{B})=P(A)-P(AB)=p-(r-p-q)=2p-r+q$

$$P(\bar{A}\bar{B})= 1 - P(\bar{A \cup B})= 1- r$$

#第二次作业：

## 第一题

*对以往数据分析结果表明，当机器调整得良好时，产品的合格率为90%，而当机器发生某一故障时，其合格率为30%。每天早上机器开动时，机器调整良好的概率为75%，试求已知某日早上第一件产品是合格品时，机器调整良好的概率是多少？*

**解：**：设$A$为某天第一件产品是合格品；$B$为机器调整良好，则$\bar{B}$为机器故障。

$$P(B|A)= \frac{P(AB)}{P(A)}=\frac{P(AB)}{P(B)|P(A|B)+P(\bar{B})P(A| \bar{B})}=\frac{0.75\times0.9}{0.75\times0.9+0.25\times0.3}=$$
0.9

## 第二题

*某零件用两种工艺加工，第一种工艺有三道工序，各道工序出现不合格品的概率分别是 0.3,0.2,0.1；第二种工艺有两道工序，各道工序出现不合格品的概率分别为0.3,0.2，试问：*

1. 用那种工艺加工得到合格品的概率较大些？
1. 第二道工艺两道工序出现不合格品的概率都是0.3时，情况有如何？

**解：**

$$P_{1pass}= P_{11pass}\cdot P_{12pass}\cdot P_{13pass}=(1-0.3)\cdot (1-0.2) \cdot (1-0.1)=$$
0.504

$$P_{2pass}= P_{21pass}\cdot P_{12pass}=(1-0.3)\cdot (1-0.2) =$$
0.56$>0.504$

**所以用第二种加工得到的合格品大！**

第二道工艺两道工序出现不合格品的概率都是0.3时，$P_{2pass}=(1-0.3)\cdot(1-0.3)=$ 0.49$<0.504$

**故用第一种加工得到的合格品大！**


## 第三题

*雨伞掉了。落在图书馆的概率为50%，这种情况下找回的概率为0.80‘落在教室的概 率为30%，这种情况下找 回的概率为0.60；落在商场的概率为20%，这种情况下    回的概率为0.05，求找回雨伞的概率。*

**解：**设$A$为找回雨伞；$B_{1},B_{2},B_{3}$分别为落在图书馆、教室和商场。

$$P(A)=P(A|B_{1})\cdot P(A|B_{2}) \cdot P(A|B_{3}) = 0.5 \cdot 0.8 +0.3 \cdot 0.6 + 0.2 \cdot 0.05=$$ 0.59


## 第四题

*某商店出售某种商品，由历史销售记录分析表明，月销售量（件）服从参数为8的泊松分布。问在月初进货 时，需要多少库存量，才能有90%的把握可以满足顾客的需求。*

**解：**设$N$为销售量则销售量满足泊松分布。根据题意，即求$n$使得$P(N\leq n) = 90\%$，即用分位数函数(quantile function)求0.9下分位点$p_{P\le0.9}$。


```r
lambda <- 8
qpois(p = 0.9,lambda = lambda)
```

```
## [1] 12
```

**故应该在月初进货12件商品。**

## 第五题

*一个交通路口的一个月交通事故次数服从平均值为7的Poisson distribution。下一个月观察到3次交通事故的概率为多少？*


```r
lambda <- 7
# 故应该在月初进货12件商品。
dpois(x = 7,lambda = lambda)
```

```
## [1] 0.1490028
```



## 第六题

[R常用函数](https://zhuanlan.zhihu.com/p/30708138)

*A study found the body heights of 126 adults.  The sample mean was 173 centimeters.  Find the margin of error E and the 95% confidence interval for µ. *


(1). The population standard deviation was 2.61 centimeters



$$E=z_{\alpha/2} \times standard error =z_{\alpha/2} \times \frac{\sigma}{\sqrt{n}}  =1.96 \times 2.61/\sqrt{126} $$ 


```r
E_1 <- 1.96*2.61/sqrt(126)
```

置信区间为$(\bar{x}-E,\bar{x}+E)$

**故margin of error E为0.4557339，左置信区间为172.5442661，右置信区间为173.4557339**

(2). The sample standard deviation was 2.61 centimeters

Use Student t distribution.

$$E=t_{\alpha/2} \times \frac{s}{\sqrt{n}}  =1.96 \times 2.61/\sqrt{126} $$

with $126-1$ degrees of freedom. Note $t_{\alpha/2}$即为下分位点$t_{T\le0.975}$


```r
t0.975 <- qt(0.975,126-1)#利用t分布的分位数函数
E_2 <- t0.975 * 2.61 /sqrt(126)
```


**故margin of error E为0.4601806，左置信区间为172.5398194，右置信区间为173.4601806**

(3). Find sample sizes n for (1) and (2) when requiring 99% confidence interval with the same E.

1. When $\sigma$ is known: $$n=(\frac{(z_{\alpha/2})\cdot\sigma}{E})^2$$
1. When $\sigma$ is unknown: $$n=(\frac{(t_{\alpha/2})\cdot s}{E})^2$$

$$此时应该是概率为0.995的下分位点。$$


```r
# sigma 已知
z0.995 <- qnorm(0.995)
sigm <- 2.61
(z0.995*sigm/0.4557339)^2
```

```
## [1] 217.6168
```

```r
# sigma 未知
s <- 2.61
t0.995 <- qt(0.995,126-1)
(t0.995*s/0.4601806)^2
```

```
## [1] 220.0956
```


**故样本量可分别取218余220。**

## 第七题

*某地汽车市场汽车平均售价是115000元，总体标准差是25000元。从该地销售的样本中随机抽取100个作为样本。问：*


(1) 售价样本均值超过110000元的概率是多少？

根据中心极限定理，$\bar{x} \sim  N(\mu,\frac{ \sigma }{ \sqrt{n}} )=N(115000,2500)$

故题目所求：
$\int_{110000}^{\infty}p(\mu=115000,s=2500)=1-P(N\le 110000)$为：


```r
1 - pnorm(q = 110000,mean = 115000,sd = 25000)
```

```
## [1] 0.5792597
```


(2) 售价样本均值在114000~116000元之间概率是多少？ 

同理：$P(114000  \le N\le 116000) = P(N \le 116000) - P(N \le 114000)$为：


```r
pnorm(q = 116000,mean = 115000,sd = 25000) - pnorm(q = 114000,mean = 115000,sd = 25000)
```

```
## [1] 0.03190687
```


(3) 售价样本均值在113000~117000元之间概率是多少？

同理：


```r
pnorm(q = 117000,mean = 115000,sd = 25000) - pnorm(q = 113000,mean = 115000,sd = 25000)
```

```
## [1] 0.06376274
```


(4)不通过计算，请指出售价的样本均值最可能落在那个区间？
1）113000~115000元 2）114000~116000元 3）115000~117000元 4）116000~118000元

**自然是包括均值的2)**

算一下也可以：


```r
calProb <- function(start,end) {
  pnorm(q = end,mean = 115000,sd = 25000) - pnorm(q = start,mean = 115000,sd = 25000)
}

x <- seq(from = 113000, by = 1000,to = 118000)
for (i in 1:4) {
  #print(c(x[i],x[i+2]))
  cat("区间与p值",x[i],x[i+2],calProb(x[i],x[i+2]),"\n")
}
```

```
## 区间与p值 113000 115000 0.03188137 
## 区间与p值 114000 116000 0.03190687 
## 区间与p值 115000 117000 0.03188137 
## 区间与p值 116000 118000 0.03180499
```

```r
##其实我们可以看看整个分布,《R语言实战》P91
x <- pretty(c(100000,130000), 60)
y <- dnorm(x = x,mean = 115000,sd = 25000)
plot(x, y,
type = "l",
xlab = "Normal Deviate",
ylab = "Density",
yaxs = "i"
)
```

![density plot](https://upload-images.jianshu.io/upload_images/3909752-fd0b6d88fdec46e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
